@model CarViewModel
@{
    ViewBag.Title = "Oferta";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>List</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.min.css" rel="stylesheet" />
    <link href="~/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body style="background-color:#f1f1f1">
    <div class="text-right">
        <br />
        <a id="btnCreateCar" class="btn btn-primary" style="color:white"><i class="ion ion-ios-add-circle-outline"></i> Dodaj nowe auto</a>
    </div><br />
    <div id="formCreateCar" style="display:none">
        <partial name="_Create" model="new Car()" />
    </div>
    <table style=" width:100%; background-color:transparent; border-color:grey; border-collapse:separate; border-spacing: 0 15px ">
        <tbody>
            @if (Model?.Cars != null && Model?.Cars.Count() > 0)
            {
                @foreach (var car in Model.Cars.OrderByDescending(c => c.CarId))
                {
                    <tr style="width:100px; height:120px; display:table-row; vertical-align:middle; ">
                        <td style="background-color:lightgray; border-top-left-radius:25px; border-bottom-left-radius:25px; width:30%" class="text-center">
                            @if (car.Photo == null)
                            {
                                <span>Brak zdjęcia</span>
                            }
                            else
                            {
                                <div class="text-left">
                                    <a class="pop" style="cursor:pointer">
                                        <img style="height:120px; width:90%; object-fit:cover; border-top-left-radius:25px; border-bottom-left-radius:25px" src="data:image/jpeg;base64,@Convert.ToBase64String(car.Photo)" />
                                    </a>
                                    <div class="modal fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-body">
                                                    <img src="" class="imagepreview" style="width: 100%;">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </td>
                        <td style="background-color:lightgray; width:40%">
                            <span data-toggle="tooltip" data-placement="top" title="Producent">@car.Manufacturer</span>&nbsp;&nbsp;<span data-toggle="tooltip" data-placement="top" title="Model">@car.Model</span> <br />
                            <span data-toggle="tooltip" data-placement="top" title="Rok produkcji">@car.YearOfProduction</span>&nbsp;&nbsp;·&nbsp;&nbsp;<span data-toggle="tooltip" data-placement="top" title="Pojemność silnika">@car.EngineSize cm3</span>&nbsp;&nbsp;·&nbsp;&nbsp;<span data-toggle="tooltip" data-placement="top" title="Rodzaj paliwa">@car.FuelType</span><br />
                            <span data-toggle="tooltip" data-placement="top" title="Rodzaj napędu">@car.Transmission</span>&nbsp;&nbsp;·&nbsp;&nbsp;<span data-toggle="tooltip" data-placement="top" title="Rodzaj nadwozia">@car.BodyType</span><br />
                            <span data-toggle="tooltip" data-placement="top" title="Kolor">@car.Color</span>
                        </td>
                        <td style="background-color:lightgray; width:15%" class="text-center">
                            <span data-toggle="tooltip" data-placement="top" title="Cena" class="font-weight-bold" style="color:royalblue">@car.Price PLN</span>
                        </td>
                        <td style="background-color:lightgray; width:5%" class="text-center">
                            <a class="popmeet" style="cursor:pointer"><span data-toggle="tooltip" data-placement="top" title="Dodaj spotkanie"><i class="fas fa-address-book" style="color:royalblue"></i></span><input id="modalId" value="@car.CarId" type="hidden" /></a>
                            <div class="modal fade" id="meetmodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div style="padding-top: 10px">Tworzenie spotkania</div>
                                        <div class="modal-body">
                                                <div class="row" style="padding-top: 10px">
                                                    <div class="col">
                                                        @using (Html.BeginForm("AddMeeting", "Car", FormMethod.Post, null))
                                                        {
                                                            <input class="modalCarId" name="modelCarId" type="hidden"/>
                                                            <input class="form-control" placeholder="Dane klienta" id="clientData" name="clientData" required />
                                                            <br />
                                                            <input class="form-control" data-date-format="dd/mm/yyyy" id="datepicker" name="dateOfMeeting" required/>
                                                            <br />
                                                            <input class="btn btn-primary" type="submit" value="Umów spotkanie"/>
                                                        }
                                                    </div>
                                                </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="background-color:lightgray; width:5%" class="text-center">
                            <a asp-action="EditCar" asp-route-editCarId="@car.CarId"><span data-toggle="tooltip" data-placement="top" title="Edytuj auto"><i class="fas fa-edit"></i></span></a>
                        </td>
                        <td style="background-color:lightgray; width:5%;border-top-right-radius:25px; border-bottom-right-radius:25px;" class="text-center">
                            <a asp-action="ArchivizeCar" asp-route-carId="@car.CarId"><span data-toggle="tooltip" data-placement="top" title="Zarchiwizuj auto"><i class="fas fa-eye-slash" style="cursor:pointer; color:red;"></i></span></a>
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr style="width: 100%; height: 60px; display: table-row; vertical-align: middle">
                    <td style="background-color:silver; border-radius:10px; width:100%" class="text-center">
                        <span>Brak aut w ofercie!</span>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" integrity="sha512-qTXRIMyZIFb8iQcfjXWCO8+M5Tbc38Qi5WzdPOYZHIlZpzBHG3L3by84BBBOiRGiEb7KKtAOAs5qYdUiZiQNNQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.pl.min.js" integrity="sha512-ScqJL8X5IqP89pKmQnXULodix6OkrTtcWiTdJxPGPGdrncyJkI7KOwNRPqzZ6lWnTk/u5xboSjEeYQgeyOHyhQ==" crossorigin="anonymous"></script>
    <script type="text/javascript">
        $('#datepicker').datepicker({
            language: 'pl',
            weekStart: 1,
            daysOfWeekHighlighted: "6,0",
            autoclose: true,
            todayHighlight: true
        });
        $('#datepicker').datepicker("setDate", new Date());
    </script>
    <br /><br />
</body>
</html>
